DROP TABLE TURMA;
DROP TABLE ALUNO;
DROP TABLE MATERIA;
DROP TABLE PROFESSOR;
DROP TABLE AVALIAÇÃO;
DROP TABLE TURMA CASCADE CONSTRAINTS;
DROP TABLE ALUNO CASCADE CONSTRAINTS;
DROP TABLE MATERIA CASCADE CONSTRAINTS;
DROP TABLE PROFESSOR CASCADE CONSTRAINTS;
DROP TABLE AVALIAÇÃO CASCADE CONSTRAINTS;

-- CRIANDO UMA TABELA

-- Criar tabela TURMA
CREATE TABLE TURMA
(
IDTURMA NUMBER (10)CONSTRAINT TURMA_IDTURMA_PK PRIMARY KEY,
NOMETURMA VARCHAR2 (20) CONSTRAINT TURMA_NOMETURMA_NN NOT NULL CONSTRAINT TURMA_NOMETURMA_UU UNIQUE,
ANOFUN DATE
);

-- Criar tabela ALUNO
CREATE TABLE ALUNO
(
IDALUNO NUMBER (10) CONSTRAINT ALUNO_IDALUNO_PK PRIMARY KEY,
IDTURMA NUMBER (10),
NOME VARCHAR2 (30)  CONSTRAINT ALUNO_NOME_NN NOT NULL,
EMAIL VARCHAR2 (80) CONSTRAINT ALUNO_EMAIL_UU  UNIQUE CONSTRAINT ALUNO_EMAIL_NN NOT NULL,
TELF NUMBER (11)    CONSTRAINT ALUNO_TELF_UU UNIQUE,
SEMESTRE NUMBER(2)  CONSTRAINT TURMA_SEMESTRE_NN NOT NULL,
CONSTRAINT ALUNO_IDTURMA_FK FOREIGN KEY (IDTURMA) REFERENCES TURMA(IDTURMA)
);

-- Criar tabela MATERIA
CREATE TABLE MATERIA
(
IDMATERIA NUMBER(10)       CONSTRAINT MATERIA_IDMATERIA_PK PRIMARY KEY,
NOMEMATERIA VARCHAR2 (20)  CONSTRAINT MATERIA_NOMEMATERIA_NN NOT NULL CONSTRAINT MATERIA_NOMEMATERIA_UU UNIQUE,
CARGAH NUMBER (8)          CONSTRAINT MATERIA_CARGAH_NN NOT NULL,  
CONSTRAINT MATERIA_CARGAH_CK CHECK (CARGAH >0)
);

-- Criar tabela PROFESSOR 
CREATE TABLE PROFESSOR
(
IDPROF NUMBER(10)      CONSTRAINT PROFESSOR_IDPROF_PK PRIMARY KEY,
IDMATERIA NUMBER(10),
FORMAÇÃO VARCHAR2 (25) CONSTRAINT PROFESSOR_FORMAÇÃO_NN NOT NULL,
NOME   VARCHAR2 (30)   CONSTRAINT PROFESSOR_NOME_NN NOT NULL,
CONSTRAINT PROFESSOR_IDMATERIA_FK FOREIGN KEY (IDMATERIA) REFERENCES MATERIA(IDMATERIA)
);

-- Criar tabela Avaliação
CREATE TABLE AVALIAÇÃO
(
IDAVAL NUMBER(10)       CONSTRAINT AVALIAÇÃO_IDAVAL_PK PRIMARY KEY,
IDPROF NUMBER(10),
DATA DATE,
IDALUNO NUMBER(10),
IDMATERIA NUMBER(10),
CONSTRAINT AVALIAÇÃO_IDPROF_FK FOREIGN KEY (IDPROF) REFERENCES PROFESSOR(IDPROF),
CONSTRAINT AVALIAÇÃO_IDALUNO_FK FOREIGN KEY (IDALUNO) REFERENCES ALUNO (IDALUNO),
CONSTRAINT AVALIAÇÃO_IDMATERIA_FK FOREIGN KEY (IDMATERIA) REFERENCES MATERIA (IDMATERIA)
);


-- Criar tabela de relação materia prof turma.
CREATE TABLE TURMA_PROFESSOR_MATERIA (
IDTURMA  NUMBER(25),
IDPROF   NUMBER(25),
IDMATERIA  NUMBER(25),

PRIMARY KEY(IDTURMA, IDPROF, IDMATERIA),
FOREIGN KEY (IDMATERIA) REFERENCES MATERIA(IDMATERIA),
FOREIGN KEY (IDTURMA) REFERENCES TURMA(IDTURMA),
FOREIGN KEY (IDPROF) REFERENCES PROFESSOR(IDPROF)
);

CREATE TABLE AVALIAÇÃO(
IDVAL  NUMBER(25),
IDPROF NUMBER(25),
IDALUNO NUMBER(25),

PRIMARY KEY ( IDVAL),
FOREIGN KEY (IDALUNO) REFERENCES ALUNO (IDALUNO),
FOREIGN KEY (IDPROF) REFERENCES PROFESSOR(IDPROF)
);



